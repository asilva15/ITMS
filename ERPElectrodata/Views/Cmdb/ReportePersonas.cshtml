@model ERPElectrodata.Models.CLASS_ENTITY

@{
    ViewBag.Title = "Find";
    Layout = null;
}

<div class="afterMain">
    <div style="float:left; width:100%;">
        <div class="titleForm"><div class="title">CMDB Personas</div></div>
        <div class="bodyForm">
            <div id="divFindTalent" class="inBodyForm">
                <form id="ParametrosPersona">
                    <fieldset>
                        <legend>ASSET</legend>
                        <div class="divFondoUno">
                            <div class="divSpace3"></div>
                            <div style="float:left;">
                                <div class="editor-label">
                                    Nombres
                                </div>
                                <div class="k-textbox">
                                    @Html.EditorFor(model => model.FIR_NAME)
                                    @Html.ValidationMessageFor(model => model.FIR_NAME)
                                </div>
                            </div>
                            <div class="divSpace3"></div>
                            <div style="float:left;">
                                <div class="editor-label">
                                    Apellidos
                                </div>
                                <div class="k-textbox">
                                    @Html.EditorFor(model => model.LAS_NAME)
                                    @Html.ValidationMessageFor(model => model.LAS_NAME)
                                </div>
                            </div>
                            <div class="divSpace3"></div>
                            <div style="float:left;">
                                <div class="editor-label">
                                    Celular
                                </div>
                                <div class="k-textbox">
                                    @Html.EditorFor(model => model.CEL_ENTI)
                                    @Html.ValidationMessageFor(model => model.CEL_ENTI)
                                </div>
                            </div>
                            <div class="divSpace3"></div>
                            <div style="float:left;">
                                <div class="editor-label">
                                    Extensión
                                </div>
                                <div class="k-textbox">
                                    @Html.EditorFor(model => model.EXT_ENTI)
                                    @Html.ValidationMessageFor(model => model.EXT_ENTI)
                                </div>
                            </div>
                            <div class="divSpace3"></div>
                            <div style="float:left;">
                                <div class="editor-label">
                                    Correo
                                </div>
                                <div class="k-textbox">
                                    @Html.EditorFor(model => model.EMA_ENTI)
                                    @Html.ValidationMessageFor(model => model.EMA_ENTI)
                                </div>
                            </div>
                        </div>
                        <div class="divFondoDos">
                            <div class="divSpace3"></div>
                            <div style="float:left;">
                                <div class="editor-label">
                                    Correo Electrodata
                                </div>
                                <div class="k-textbox">
                                    @Html.TextBox("EMA_ELEC")
                                </div>
                            </div>
                            <div class="divSpace3"></div>
                            <div style="float:left;">
                                <div class="editor-label">
                                    Correo Personal
                                </div>
                                <div class="k-textbox">
                                    @Html.TextBox("EMA_PERS")
                                </div>
                            </div>
                            <div class="divSpace3"></div>
                            <div style="float:left;">
                                <div class="editor-label">
                                    Lugar - Ubicación
                                </div>
                                <div class="editor-field">
                                    @Html.Editor("ID_LOCA")
                                </div>
                            </div>
                            <div class="divSpace3"></div>
                            <div style="float:left;">
                                <div class="editor-label">
                                    Area
                                </div>
                                <div class="editor-field">
                                    <input type="text" id="ID_TYPE_CHAR" name="ID_TYPE_CHAR" />
                                </div>
                            </div>
                            <div class="divSpace3"></div>
                            <div style="float:left;" id="divOrganization">
                                <div class="editor-label" id="divOrgaTitle">
                                    -
                                </div>
                                <div class="editor-field">
                                    <input type="text" id="ID_NAM_CHAR" name="ID_NAM_CHAR" />
                                </div>
                            </div>
                            <div id="divChart" style="float:left;display:none;">
                                <div class="editor-label">
                                    <a href="#" onclick="JobTitle()" title="@ResourceLanguaje.Resource.SelectJobTitle">Cargo</a>
                                </div>
                                <input type="hidden" name="ID_CHART" value="0" id="ID_CHART" />
                                <div class="k-textbox">
                                    <input type="text" id="NAM_CHART" name="NAM_CHART" readonly="readonly" style="text-transform:capitalize;" />
                                </div>
                            </div>
                        </div>
                        <div class="divFondoUno">
                            <div class="divSpace3"></div>
                            <div style="float:left;">
                                <div class="editor-label">
                                    Estado
                                </div>
                                <div class="editor-field">
                                    @Html.Editor("ID_PERS_STAT1")
                                </div>
                            </div>
                            <div class="divSpace3"></div>
                            <div style="float:left;">
                                <div class="editor-label">
                                    Condición
                                </div>
                                <div class="editor-field">
                                    @Html.Editor("ID_COND_CONT1")
                                </div>
                            </div>
                            <div class="divSpace3"></div>
                            <div style="float:left;">
                                <div class="editor-label">
                                    Fecha Inicio Contrato
                                </div>
                                <div class="editor-field">
                                    @Html.TextBox("START_DATE1")
                                </div>
                            </div>
                            <div class="divSpace3"></div>
                            <div style="float:left;">
                                <div class="editor-label">
                                    Fecha Fin Contrato
                                </div>
                                <div class="editor-field">
                                    @Html.TextBox("END_DATE1")
                                </div>
                            </div>
                            <div class="divSpace3"></div>
                            <div style="float:left;">
                                <div class="editor-label">
                                    Catágogo de Servicios
                                </div>
                                <div class="editor-field">
                                    <input type="text" id="IdCatalogo" name="IdCatalogo" />
                                </div>
                            </div>
                        </div>
                        <div class="divFondoDos" style="margin-bottom:5px;">
                            <div class="divSpace3"></div>
                            <div style="display:inline-block; float:right; padding:5px 10px 0px 5px;">
                                <div style=" float:left; padding:0px 15px 0px 0px; ">
                                    <button id="btnBuscar" class="k-button">Buscar</button>
                                </div>
                            </div>
                        </div>
                    </fieldset>
                </form>
            </div>
        </div>
    </div>
</div>

<div class="bodyForm" style="margin-top:10px;">
    <div class="inBodyForm">
        <iframe id="RSPersona" style="height:570px; width:100%;border: 0px #eee solid;"></iframe>
    </div>
</div>

<script id="treeview-template" type="text/kendo-ui-template">
    # if (data.NIV_AREA == 2) { #
    # if (data.SwImagen != 0) { #
    <img src="/Content/Images/ping.png" /> &nbsp#: data.NOM_AREA #
    # } else { #
    #: data.NOM_AREA #
    # } #
    # } else if (data.NIV_AREA == 3) { #
    # if (data.SwImagen != 0) { #
    <img style="margin-left:20px;" src="/Content/Images/ping.png" /> &nbsp#: data.NOM_AREA #
    # } else { #
    <span style="margin-left:20px;"> #: data.NOM_AREA #</span>
    # } #x
    # } else if (data.NIV_AREA == 4) { #
    <span style="margin-left:40px;"> #: data.NOM_AREA #</span>
    # } #
</script>

<script type="text/javascript">

    $.get("/TalentChart/ListType_Chart",function(json){
        json["Data"].push({NAM_TYPE: "Job Title by Organization Chart", ID_TYPE_CHAR: 0});

        var ID_TYPE_CHAR = $("#ID_TYPE_CHAR").kendoComboBox({
            dataTextField: "NAM_TYPE",
            dataValueField: "ID_TYPE_CHAR",
            filter: "contains",
            autoBind: true,
            delay: 500,
            minLength: 0,
            suggest: true,
            dataSource: json["Data"]
        }).data("kendoComboBox");

        var ID_NAM_CHAR = $("#ID_NAM_CHAR").kendoComboBox({
            cascadeFrom: "ID_TYPE_CHAR",
            dataTextField: "NAM_CHAR",
            dataValueField: "ID_NAM_CHAR",
            filter: "contains",
            autoBind: false,
            delay: 500,
            minLength: 0,
            suggest: true,
            dataSource: {
                serverFiltering: true,
                schema: {
                    data: "Data",
                    total: "Count"
                },
                transport: {
                    read: "/TalentChart/ListNamCharByTypeChart?var=" + Math.random()
                }
            }
        }).data("kendoComboBox");

        ID_TYPE_CHAR.bind("change", function(e) {
            if (ID_TYPE_CHAR.dataItem().ID_TYPE_CHAR == 0) {
                $("#divOrganization").css("display","none");
                $("#divChart").css("display","block");
            }
            else{
                $("#divOrganization").css("display","block");
                $("#divOrgaTitle").html(ID_TYPE_CHAR.dataItem().NAM_TYPE);

                $("#divChart").css("display","none");
            }
        });

    });

    $("#ID_LOCA").kendoComboBox({
        dataTextField: "NAME",
        dataValueField: "ID_LOCA",
        template: '<div style="font-weight:bold;">${ data.NAM_SITE }</div>' +
                    '<div>${ data.NAM_LOCA }</div>',
        filter: "contains",
        autoBind: false,
        delay: 500,
        minLength: 0,
        suggest: true,
        dataSource: {
            serverFiltering: false,
            schema: {
                data: "Data",
                total: "Count"
            },
            transport: {
                read: "/Location_Entity/List?var=" + Math.random()
            }
        }
    });
    var ID_LOCA = $("#ID_LOCA").data("kendoComboBox");
    ID_LOCA.list.width(300);

    $("#ID_PERS_STAT1").kendoComboBox({
        dataTextField: "NAM_STAT",
        dataValueField: "ID_PERS_STAT",
        filter: "contains",
        autoBind: false,
        delay: 500,
        minLength: 0,
        suggest: false,
        dataSource: {
            serverFiltering: false,
            schema: {
                data: "Data",
                total: "Count"
            },
            transport: {
                read: "/Person_Status/ListAll?var=" + Math.random()
            }
        }
    });

    $("#ID_COND_CONT1").kendoComboBox({
        dataTextField: "NAM_COND",
        dataValueField: "ID_COND_CONT",
        filter: "contains",
        autoBind: false,
        delay: 500,
        minLength: 0,
        suggest: true,
        dataSource: {
            serverFiltering: false,
            schema: {
                data: "Data",
                total: "Count"
            },
            transport: {
                read: "/Contract_Condition/List?var=" + Math.random()
            }
        }
    });

    var IdCatalogo = $("#IdCatalogo").kendoComboBox({
        autoBind: false,
        filter: "contains",
        dataTextField: "NombreServicio",
        dataValueField: "Id",
        dataSource: {
            serverFiltering: false,
            schema: {
                data: "Data"
            },
            transport: {
                read: "/CatalogoServicio/Listar?var=" + Math.random()
            }
        }
    }).data("kendoComboBox");

    var START_DATE1 = $("#START_DATE1").kendoDateTimePicker().data("kendoDateTimePicker");
    var END_DATE1 = $("#END_DATE1").kendoDateTimePicker().data("kendoDateTimePicker");

    $("#btnBuscar").click(function () {
        event.preventDefault();
        var nombres = $("#FIR_NAME").val();
        var apellidos = $("#LAS_NAME").val();
        var celular = $("#CEL_ENTI").val();
        var extension = $("#EXT_ENTI").val();
        var correo = $("#EMA_ENTI").val();
        var correoElectrodata = $("#EMA_ELEC").val();
        var correoPersonal = $("#EMA_PERS").val();
        var locacion = $("#ID_LOCA").val();
        var tipoCargo = $("#ID_TYPE_CHAR").val();
        var idNombreCargo = $("#ID_NAM_CHAR").val();
        var cargo = $("#NAM_CHART").val();
        var estado = $("#ID_PERS_STAT1").val();
        var condicion = $("#ID_COND_CONT1").val();
        var fechaInicio = $("#START_DATE1").val();
        var fechaFin = $("#END_DATE1").val();
        var catalogoServicio = $("#IdCatalogo").val();

        window.frames["RSPersona"].src = '/Reporting/Cmdb/ReportePersona.aspx?n=' + nombres + '&a=' + apellidos + '&cl=' + celular + '&ex=' + extension + '&cr=' + correo
            + '&ce=' + correoElectrodata + '&cp=' + correoPersonal + '&l=' + locacion + '&tc=' + tipoCargo + '&ic=' + idNombreCargo + '&c=' + cargo + '&e=' + estado
            + '&co=' + condicion + '&fi=' + fechaInicio + '&ff=' + fechaFin + '&ct=' +catalogoServicio;
    });

</script>

@model ERPElectrodata.Models.Categoria
@{
    Layout = null;
}
<div class="row">
    <div class="col-md-12">
        <div class="main-card card">
            @using (Html.BeginForm("AgregarCategoria", "ServiceNow", FormMethod.Post, new { enctype = "multipart/form-data", id = "FrmEditarCategoria", target = "upload_target" }))
            {
                <div class="card-body">
                    <div class="col-md-12">
                        <div class="form-row">
                            <div class="col-md-12">
                                <div class="form-row">
                                    <div class="col-md-8">
                                        <div class="form-group">
                                            <label id="" for="" class=""> Descripción Categoria</label>
                                            <input class="form-control" type="text" id="Categoria1" name="Categoria1" value="@Model.Categoria1" />
                                        </div>
                                    </div>
                                    <div class="col-md-4">
                                        <div class="form-group">
                                            <label id="" for="" class="">Tipo de Atención</label>
                                            <select id="id_TipoAtencion" name="id_TipoAtencion" class="form-control">
                                            </select>
                                        </div>
                                    </div>
                                </div>
                                <div class="form-row">
                                    <div class="col-md-2">
                                        <div class="form-group">
                                            <label class="titulo"></label>
                                            <label class="font-weight-bold">Horas Estimadas</label>
                                        </div>
                                    </div>
                                    <div class="col-md-8 form-row">
                                        <div class="col-md-2">
                                            <div class="form-group">
                                                <label class="titulo">Supervisión</label>
                                                <input class="form-control" type="number" id="Supervision_estimado" name="Supervision_estimado" value="0" step="any" />
                                            </div>
                                        </div>
                                        <div class="col-md-2">
                                            <div class="form-group">
                                                <label class="titulo">Infraestructura</label>
                                                <input class="form-control" type="number" id="Infraestructura_estimado" name="Infraestructura_estimado" value="0" step="any" />
                                            </div>
                                        </div>
                                        <div class="col-md-2">
                                            <div class="form-group">
                                                <label class="titulo">HelpDesk</label>
                                                <input class="form-control" type="number" id="HelpDesk_estimado" name="HelpDesk_estimado" value="0" step="any" />
                                            </div>
                                        </div>
                                        <div class="col-md-2">
                                            <div class="form-group">
                                                <label class="titulo">Soporte Usuario</label>
                                                <input class="form-control" type="number" id="SoporteUser_estimado" name="SoporteUser_estimado" value="0" step="any" />
                                            </div>
                                        </div>
                                        <div class="col-md-2">
                                            <div class="form-group">
                                                <label class="titulo">Arquitectura</label>
                                                <input class="form-control" type="number" id="Arquitectura_estimado" name="Arquitectura_estimado" value="0" step="any" />
                                            </div>
                                        </div>
                                        <div class="col-md-2">
                                            <div class="form-group">
                                                <label class="titulo">Servicio DBA</label>
                                                <input class="form-control" type="number" id="ServicioDBA_estimado" name="ServicioDBA_estimado" value="0" step="any" />
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-md-2">
                                        <div class="form-group">
                                            <label class="titulo font-weight-bold">Total</label>
                                            <input class="form-control" type="number" id="TotalHoras_estimado" name="TotalHoras_estimado" value="0" step="any" readonly />
                                        </div>
                                    </div>
                                </div>
                                <div class="form-row">
                                    <div class="col-md-2">
                                        <label class="font-weight-bold">Horas Reales</label>
                                    </div>
                                    <div class="col-md-8 form-row">
                                        <div class="col-md-2">
                                            <div class="form-group">
                                                <input class="form-control" type="number" id="Supervision_real" name="Supervision_real" value="0" step="any" />
                                            </div>
                                        </div>
                                        <div class="col-md-2">
                                            <div class="form-group">
                                                <input class="form-control" type="number" id="Infraestructura_real" name="Infraestructura_real" value="0" step="any" />
                                            </div>
                                        </div>
                                        <div class="col-md-2">
                                            <div class="form-group">
                                                <input class="form-control" type="number" id="HelpDesk_real" name="HelpDesk_real" value="0" step="any" />
                                            </div>
                                        </div>
                                        <div class="col-md-2">
                                            <div class="form-group">
                                                <input class="form-control" type="number" id="SoporteUser_real" name="SoporteUser_real" value="0" step="any" />
                                            </div>
                                        </div>
                                        <div class="col-md-2">
                                            <div class="form-group">
                                                <input class="form-control" type="number" id="Arquitectura_real" name="Arquitectura_real" value="0" step="any" />
                                            </div>
                                        </div>
                                        <div class="col-md-2">
                                            <div class="form-group">
                                                <input class="form-control" type="number" id="ServicioDBA_real" name="ServicioDBA_real" value="0" step="any" />
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-md-2">
                                        <div class="form-group">
                                            <input class="form-control" type="number" id="TotalHoras_real" name="TotalHoras_real" value="0" step="any" readonly />
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="d-block text-right card-footer">
                    <button class="btn-shadow btn btn-primary" id="submit" type="submit">Guardar</button>
                </div>
            }

        </div>
    </div>
    <button id="closeModal" data-dismiss="modal" hidden></button>
</div>
<script>
    $(document).ready(function () {
        $.ajax({
            url: '/ServiceNow/ObtenerTiposAtencionPorId',
            type: "GET",
            dataType: "json",
            success: function (data) {
                let atencionSelect = $('#id_TipoAtencion').select2({
                    data: data.data,
                    theme: "bootstrap"
                });
            }
        })
    })

    //Cambio total de Horas
    //Estimado
    $('#Supervision_estimado').on('change', function (e) {
        calcularTotalHorasEstimadas()
    })
    $('#Infraestructura_estimado').on('change', function (e) {
        calcularTotalHorasEstimadas()
    })
    $('#HelpDesk_estimado').on('change', function (e) {
        calcularTotalHorasEstimadas()
    })
    $('#SoporteUser_estimado').on('change', function (e) {
        calcularTotalHorasEstimadas()
    })
    $('#Arquitectura_estimado').on('change', function (e) {
        calcularTotalHorasEstimadas()
    })
    $('#ServicioDBA_estimado').on('change', function (e) {
        calcularTotalHorasEstimadas()
    })
    //Real
    $('#Supervision_real').on('change', function (e) {
        calcularTotalHorasReales()
    })
    $('#Infraestructura_real').on('change', function (e) {
        calcularTotalHorasReales()
    })
    $('#HelpDesk_real').on('change', function (e) {
        calcularTotalHorasReales()
    })
    $('#SoporteUser_real').on('change', function (e) {
        calcularTotalHorasReales()
    })
    $('#Arquitectura_real').on('change', function (e) {
        calcularTotalHorasReales()
    })
    $('#ServicioDBA_real').on('change', function (e) {
        calcularTotalHorasReales()
    })
    function calcularTotalHorasEstimadas() {
        const supervEst = parseFloat(document.getElementById('Supervision_estimado').value)
        const InfraEst = parseFloat(document.getElementById('Infraestructura_estimado').value)
        const helpDeskEst = parseFloat(document.getElementById('HelpDesk_estimado').value)
        const SoporteUserEst = parseFloat(document.getElementById('SoporteUser_estimado').value)
        const ArquiEst = parseFloat(document.getElementById('Arquitectura_estimado').value)
        const ServDBAEst = parseFloat(document.getElementById('ServicioDBA_estimado').value)
        const horasEstimada = supervEst + InfraEst + helpDeskEst + SoporteUserEst + ArquiEst + ServDBAEst
        console.log({ supervEst })
        console.log({ InfraEst })
        console.log({ helpDeskEst })
        console.log({ SoporteUserEst })
        console.log({ ArquiEst })
        console.log({ ServDBAEst })
        document.getElementById('TotalHoras_estimado').value = horasEstimada.toFixed(2)
    }
    function calcularTotalHorasReales() {
        const supervReal = parseFloat(document.getElementById('Supervision_real').value)
        const InfraReal = parseFloat(document.getElementById('Infraestructura_real').value)
        const helpDeskReal = parseFloat(document.getElementById('HelpDesk_real').value)
        const SoporteUserReal = parseFloat(document.getElementById('SoporteUser_real').value)
        const ArquiReal = parseFloat(document.getElementById('Arquitectura_real').value)
        const ServDBAReal = parseFloat(document.getElementById('ServicioDBA_real').value)
        const horasReal = supervReal + InfraReal + helpDeskReal + SoporteUserReal + ArquiReal + ServDBAReal
        document.getElementById('TotalHoras_real').value = horasReal.toFixed(2)
    }
</script>
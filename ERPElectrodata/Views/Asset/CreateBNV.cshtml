@model ERPElectrodata.Models.ASSET

@{
    ViewBag.Title = "Create";
    //Layout = null;
}

<style>
    .editCombo {
        position: absolute;
        background-image: url(/Content/Images/Edit.png);
        background-repeat: no-repeat;
        width: 16px;
        height: 16px;
        top: 29px;
        right: 60px;
        cursor: pointer;
        z-index: 999;
    }

    .select2-container--default .select2-selection--multiple {
        overflow-y: auto;
        white-space: normal;
    }
</style>

<script src="~/Content/themes/plugin/toastr/toastr.min.js"></script>
<link href="~/Content/themes/plugin/toastr/toastr.min.css" rel="stylesheet" />

<link href="~/Content/themes/plugin/DataTables/datatables.css" rel="stylesheet" />
<link href="~/Content/themes/plugin/DataTables/Buttons-1.4.2/css/buttons.bootstrap.css" rel="stylesheet" />
<link href="~/Content/themes/plugin/DataTables/DataTables-1.10.16/css/dataTables.bootstrap4.css" rel="stylesheet" />

<script src="~/Content/themes/plugin/DataTables/datatables.js"></script>
<script src="~/Content/themes/plugin/DataTables/Buttons-1.4.2/js/buttons.bootstrap.js"></script>
<script src="~/Content/themes/plugin/DataTables/Buttons-1.4.2/js/dataTables.buttons.js"></script>
<script src="~/Content/themes/plugin/DataTables/DataTables-1.10.16/js/dataTables.bootstrap4.js"></script>

<link href="~/Content/themes/plugin/select2/select2.css" rel="stylesheet" />
<script src="~/Content/themes/plugin/select2/select2.full.js"></script>

<div class="mb-3 card">
    <div class="card-header-tab card-header">Nuevo Activo</div>
    <div class="card-body">
        @using (Html.BeginForm("CreateBNV", "Asset", FormMethod.Post, new { enctype = "multipart/form-data", id = "FrmAsset", target = "upload_target" }))
        {
            <fieldset>
                @*@Html.HiddenFor(model => model.IdGrupo)*@
                @*<input type="hidden" id="idUMin" name="idUMin" value="@Model.UMinera" />*@
                <div class="row">
                    <div class="col-sm-6 col-lg-3">
                        <div class="editor-label">
                            Grupo <b style="color:red">(*)</b>
                        </div>
                        <div class="editor-field">
                            @Html.EditorFor(model => model.IdGrupo)
                            @Html.ValidationMessageFor(model => model.IdGrupo)
                        </div>
                    </div>
                    <div class="col-sm-6 col-lg-3">
                        <div class="editor-label">
                            Unidad Minera <b style="color:red">(*)</b>
                        </div>
                        <div class="editor-field">
                            @Html.EditorFor(model => model.UMinera)
                            @Html.ValidationMessageFor(model => model.UMinera)
                        </div>
                    </div>
                    <div class="col-sm-6 col-lg-3">
                        <div id="NuevoTipoActivo" class="editor-label">
                            Tipo de Activo <b style="color:red">(*)</b>
                        </div>
                        <div class="editor-field">
                            @Html.TextBoxFor(model => model.ID_TYPE_ASSE)
                            @Html.ValidationMessageFor(model => model.ID_TYPE_ASSE)
                        </div>
                    </div>
                    <div class="col-sm-6 col-lg-3">
                        <div class="editor-label">
                            Número de Serie <b style="color:red">(*)</b>
                        </div>
                        <div class="k-textbox" style="width:100%">
                            @Html.EditorFor(model => model.SER_NUMB)
                            @Html.ValidationMessageFor(model => model.SER_NUMB)
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="col-sm-6 col-lg-3 divInfraestructura">
                        <div id="NuevaLocacion" class="editor-label">
                            Locación
                        </div>
                        <div class="editor-field">
                            <input id="Locacion" name="Locacion" />
                        </div>
                    </div>
                    <div class="col-sm-6 col-lg-3">
                        <div class="editor-label">
                            <span id="txtNombre"></span>
                        </div>
                        <div class="k-textbox" style="width:100%">
                            @Html.EditorFor(model => model.NAM_EQUI)
                        </div>
                    </div>
                    <div class="col-sm-6 col-lg-3">
                        <div class="editor-label">
                            <div id="NuevaMarca" class="editor-label">
                                Marca / Fabricante <b style="color:red">(*)</b>
                            </div>
                        </div>
                        <div class="editor-field">
                            @Html.TextBoxFor(model => model.ID_MANU)
                            @Html.ValidationMessageFor(model => model.ID_MANU)
                        </div>
                        <div id="divEditManufacturer" style="display:none;" class="editCombo" onclick="EditManufacturer()" title="Clic aquí para editar una marca" data-toggle="modal" data-target="#miModal"></div>
                    </div>
                    <div class="col-sm-6 col-lg-3">
                        <div class="editor-label">
                            <div id="NuevoModeloComercial" class="editor-label">
                                Modelo Comercial <b style="color:red">(*)</b>
                            </div>
                        </div>
                        <div class="editor-field">
                            @Html.TextBoxFor(model => model.ID_COMM_MODE)
                            @Html.ValidationMessageFor(model => model.ID_COMM_MODE)
                        </div>
                        <div id="divEditCommercialModel" style="display:none;" class="editCombo" onclick="EditCommercialModel()" title="Clic aquí para editar un modelo comercial" data-toggle="modal" data-target="#miModal"></div>
                    </div>
                    <div class="col-sm-6 col-lg-3 divMicroinformatico divMovil">
                        <div class="editor-label">
                            <span id="txtTarifa"></span>
                        </div>
                        <div class="editor-field">
                            @Html.EditorFor(model => model.COST)
                            @Html.ValidationMessageFor(model => model.COST)
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="col-sm-6 col-lg-3 divMovil">
                        <div class="editor-label">
                            Monto total Plan
                        </div>
                        <div class="editor-field">
                            @Html.EditorFor(model => model.MontoTotal)
                        </div>
                    </div>
                    <div class="col-sm-6 col-lg-3 divMovil">
                        <div class="editor-label">
                            Modalidad
                        </div>
                        <div class="editor-field">
                            @Html.TextBoxFor(model => model.IdModalidad)
                        </div>
                    </div>
                    <div class="col-sm-6 col-lg-3 divMovil">
                        <div id="NuevoOperador" class="editor-label">
                            Operador
                        </div>
                        <div class="editor-field">
                            @Html.TextBoxFor(model => model.IdOperador)
                        </div>
                    </div>
                    <div class="col-sm-6 col-lg-3 divMovil">
                        <div id="NuevoPlan" class="editor-label">
                            Plan
                        </div>
                        <div class="editor-field">
                            @Html.TextBoxFor(model => model.IdPlan)
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="col-sm-6 col-lg-3 divInfraestructura">
                        <div class="editor-label">
                            Modo de Compra <b style="color:red">(*)</b>
                        </div>
                        <div class="editor-field">
                            @Html.EditorFor(model => model.ID_BUY_MODE)
                            @Html.ValidationMessageFor(model => model.ID_BUY_MODE)
                        </div>
                    </div>
                    <div class="col-sm-6 col-lg-3">
                        <div id="NuevoContrato" class="editor-label">
                            <span id="txtContrato"></span> <b style='color:red'>(*)</b>
                        </div>
                        <div class="editor-field">
                            @Html.TextBoxFor(model => model.IdContrato)
                            @Html.ValidationMessageFor(model => model.IdContrato)
                        </div>
                    </div>
                    <div class="col-sm-6 col-lg-3 divMicroinformaticoDass" style="display:none;">
                        <div class="editor-label">
                            Fecha de Inicio @ResourceLanguaje.Resource.DateFormat <b style="color:red" class="bFechasMovil">(*)</b>
                        </div>
                        <div class="editor-field">
                            @Html.EditorFor(model => model.ACQ_DATE)
                        </div>
                    </div>
                    <div class="col-sm-6 col-lg-3 divMicroinformaticoDass" style="display:none;">
                        <div class="editor-label">
                            Fecha <span id="txtFFin"></span> @ResourceLanguaje.Resource.DateFormat <b id="bFechaFin" style="color:red" class="bFechasMovil">(*)</b>
                        </div>
                        <div class="editor-field">
                            @Html.EditorFor(model => model.FechaFin)
                        </div>
                    </div>
                    <div class="col-sm-6 col-lg-3 divInfraestructura divMovil">
                        <div class="editor-label">
                            <span id="txtIpLocal"></span>
                        </div>
                        <div class="k-textbox" style="width:100%">
                            @Html.EditorFor(model => model.IpLocal)
                            @Html.ValidationMessageFor(model => model.IpLocal)
                        </div>
                    </div>
                    <div class="col-sm-6 col-lg-3 divInfraestructura">
                        <div class="editor-label">
                            MAC Física
                        </div>
                        <div class="k-textbox" style="width:100%">
                            @Html.EditorFor(model => model.MAC_ADRR)
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="col-sm-6 col-lg-3 divInfraestructuraSer" style="display:none;">
                        <div class="editor-label">
                            Procesador 1 - RAM 1
                        </div>
                        <div class="k-textbox" style="width:100%">
                            @Html.EditorFor(model => model.ProcesadorRam1)
                        </div>
                    </div>
                    <div class="col-sm-6 col-lg-3 divInfraestructuraSer" style="display:none;">
                        <div class="editor-label">
                            Procesador 2 - RAM 2
                        </div>
                        <div class="k-textbox" style="width:100%">
                            @Html.EditorFor(model => model.ProcesadorRam2)
                        </div>
                    </div>
                    <div class="col-sm-6 col-lg-3 divInfraestructuraSer" style="display:none;">
                        <div class="editor-label">
                            Cantidad HD
                        </div>
                        <div class="editor-field">
                            @Html.EditorFor(model => model.CantidadHD)
                        </div>
                    </div>
                    <div class="col-sm-6 col-lg-3 divInfraestructuraSer" style="display:none;">
                        <div class="editor-label">
                            Capacidad HD
                        </div>
                        <div class="k-textbox" style="width:100%">
                            @Html.EditorFor(model => model.CapacidadHD)
                        </div>
                    </div>
                    <div class="col-sm-6 col-lg-3 divMovil">
                        <div id="NuevaAplicacion" class="editor-label">
                            Aplicaciones
                        </div>
                        <div class="editor-field">
                            <select id="aplicacionesMovil" name="aplicacionesMovil" class="select2" multiple="multiple" style="width:100%"></select>
                        </div>
                    </div>
                    <div class="col-sm-6 col-lg-3 divMovil">
                        <div class="editor-label">
                            Antivirus
                        </div>
                        <div class="editor-field">
                            <input type="checkbox" id="Antivirus" name="AntivirusMovil" />
                        </div>
                    </div>
                </div>
                <div class="form-group row">
                    <div class="col-sm-12 col-lg-12">
                        <div class="editor-label">
                            <span id="txtComentario"></span>
                        </div>
                        <div class="editor-field">
                            @Html.TextAreaFor(model => model.SUM_ASSE)
                            @Html.ValidationMessageFor(model => model.SUM_ASSE)
                        </div>
                    </div>
                </div>
                <div class="form-group row">
                    <div class="col-sm-12 col-lg-12">
                        <input name="archivos" id="archivos" type="file" />
                    </div>
                </div>
                <div class="row">
                    <div class="col-sm-12 col-lg-8">
                        <br />
                    </div>
                    <div class="col-sm-12 col-lg-2">
                        <button id="reset" class="btn btn-light btn-block" onclick="cancel(); return false;">Ir al Listado</button>
                    </div>
                    <div class="col-sm-12 col-lg-2">
                        <button id="submit" class="btn btn-primary btn-block"><i class="fa fa-save"></i> Guardar</button>
                    </div>
                </div>
                <iframe id="upload_target" name="upload_target" src="" style="display:none;"></iframe>
            </fieldset>
        }
    </div>
</div>

<button id="btnMensajeConfirmacion" class="k-button" data-backdrop="static" data-keyboard="false" data-toggle="modal" data-target="#miModal" style="display:none">Mensaje</button>

<script type="text/javascript">

    $(document).ready(function () {

        var IdGrupo = $("#IdGrupo").kendoComboBox({
            index: 0,
            dataTextField: "Nombre",
            dataValueField: "Id",
            filter: "contains",
            autoBind: true,
            delay: 500,
            minLength: 0,
            suggest: true,
            dataSource: {
                schema: {
                    data: "Data",
                    total: "Count"
                },
                transport: {
                    read: "/Asset/ListarGruposBNV/1?var=" + Math.random()
                }
            },
            change: function (e) {
                MostrarDatosxGrupo(IdGrupo.text());
            },
            dataBound: function (e) {
                MostrarDatosxGrupo(IdGrupo.text());
            }
        }).data("kendoComboBox");

        var UMinera = $("#UMinera").kendoComboBox({
            dataTextField: "COM_NAME",
            dataValueField: "ID_ENTI",
            cascadeFrom: 'IdGrupo',
            filter: "contains",
            autoBind: false,
            delay: 500,
            minLength: 0,
            suggest: true,
            dataSource: {
                serverFiltering: true,
                schema: {
                    data: "Data",
                    total: "Count"
                },
                transport: {
                    read: "/Asset/ListarUMineraBNV?var=" + Math.random()
                }
            },
            dataBound: function (e) {
                if (UMinera.dataSource.view().length == 1) {
                    UMinera.select(0);
                }
            }
        }).data("kendoComboBox");

        var Locacion = $("#Locacion").kendoComboBox({
            dataTextField: "NAM_LOCA",
            dataValueField: "ID_LOCA",
            cascadeFrom: 'UMinera',
            template: '<div><div style="font-weight:bold;">${ data.NAM_SITE }</div>' +
                '<div>${ data.NAM_LOCA }</div></div>',
            filter: "contains",
            autoBind: false,
            delay: 500,
            minLength: 0,
            suggest: true,
            dataSource: {
                serverFiltering: true,
                schema: {
                    data: "Data",
                    total: "Count"
                },
                transport: {
                    read: {
                        url: "/Asset/ListarLocacionBNV",
                        data: function () {
                            return {
                                idGrupo: IdGrupo.value(),
                                var: Math.random()
                            };
                        }
                    }
                }
            }
        }).data("kendoComboBox");

        var ID_TYPE_ASSE = $("#ID_TYPE_ASSE").kendoComboBox({
            dataTextField: "NAM_TYPE_ASSE",
            dataValueField: "ID_TYPE_ASSE",
            cascadeFrom: 'IdGrupo',
            filter: "contains",
            autoBind: false,
            delay: 500,
            minLength: 0,
            suggest: true,
            dataSource: {
                serverFiltering: true,
                schema: {
                    data: "Data",
                    total: "Count"
                },
                transport: {
                    read: "/TypeAsset/ListarTipoActivoxGrupoBNV?var=" + Math.random()
                }
            },
            change: function (e) {
                if (IdGrupo.text() == 'INFRAESTRUCTURA' && ID_TYPE_ASSE.text() == 'SERVIDOR') {
                    $(".divInfraestructuraSer").css("display", "block");
                } else {
                    $("#CantidadHD").data("kendoNumericTextBox").value(null);
                    $("#ProcesadorRam1").val("");
                    $("#ProcesadorRam2").val("");
                    $("#CapacidadHD").val("");
                    $(".divInfraestructuraSer").css("display", "none");
                }
            }
        }).data("kendoComboBox");

        var ID_MANU = $("#ID_MANU").kendoComboBox({
            dataTextField: "NAM_MANU",
            dataValueField: "ID_MANU",
            cascadeFrom: 'IdGrupo',
            filter: "contains",
            autoBind: false,
            delay: 500,
            minLength: 0,
            suggest: true,
            dataSource: {
                serverFiltering: true,
                schema: {
                    data: "Data",
                    total: "Count"
                },
                transport: {
                    read: "/Manufacturer/ListarMarcasBNV?var=" + Math.random()
                }
            }
        }).data("kendoComboBox");

        var ID_COME_MODE = $("#ID_COMM_MODE").kendoComboBox({
            dataTextField: "NAM_COMM_MODE",
            dataValueField: "ID_COMM_MODE",
            cascadeFrom: 'ID_MANU',
            filter: "contains",
            autoBind: false,
            delay: 500,
            minLength: 0,
            suggest: true,
            dataSource: {
                serverFiltering: true,
                schema: {
                    data: "Data",
                    total: "Count"
                },
                transport: {
                    read: {
                        url: "/CommercialModel/ListarModelosBNV",
                        data: function() {
                            return {
                                idGrupo: IdGrupo.value(),
                                var: Math.random()
                            };
                        }
                    }
                    //read: "/CommercialModel/ListarModelosBNV?idGrupo=" + IdGrupo.value() + "&var=" + Math.random()
                }
            }
        }).data("kendoComboBox");

        var ID_BUY_MODE = $("#ID_BUY_MODE").kendoComboBox({
            dataTextField: "NAM_BUY_MODE",
            dataValueField: "ID_BUY_MODE",
            cascadeFrom: 'IdGrupo',
            filter: "contains",
            autoBind: false,
            delay: 500,
            minLength: 0,
            suggest: true,
            dataSource: {
                serverFiltering: true,
                schema: {
                    data: "Data",
                    total: "Count"
                },
                transport: {
                    read: "/BuyMode/ListarModosCompraBNV?var=" + Math.random()
                }
            }
        }).data("kendoComboBox");

        var IdContrato = $("#IdContrato").kendoComboBox({
            dataTextField: "Nombre",
            dataValueField: "Id",
            cascadeFrom: 'IdGrupo',
            filter: "contains",
            autoBind: false,
            delay: 500,
            minLength: 0,
            suggest: true,
            dataSource: {
                serverFiltering: true,
                schema: {
                    data: "Data",
                    total: "Count"
                },
                transport: {
                    read: "/Asset/ListarProyectosBNV?var=" + Math.random()
                }
            },
            change: function (e) {
                if (IdGrupo.text() == 'MICROINFORMATICO' && IdContrato.text() == 'DaaS') {
                    $(".divMicroinformaticoDass").css("display", "block");
                    $("#bFechaFin").css("display", "inline");
                } else if (IdGrupo.text() == 'MICROINFORMATICO' && IdContrato.text() == 'Alquiler') {
                    $(".divMicroinformaticoDass").css("display", "block");
                    $("#bFechaFin").css("display", "none");
                } else if (IdGrupo.text() == 'MICROINFORMATICO') {
                    FEC_TICK.value(null);
                    FechaFin.value(null);
                    $(".divMicroinformaticoDass").css("display", "none");
                }
            }
        }).data("kendoComboBox");

        var IdModalidad = $("#IdModalidad").kendoComboBox({
            dataTextField: "Nombre",
            dataValueField: "Id",
            cascadeFrom: 'IdGrupo',
            filter: "contains",
            autoBind: false,
            delay: 500,
            minLength: 0,
            suggest: true,
            dataSource: {
                serverFiltering: true,
                schema: {
                    data: "Data",
                    total: "Count"
                },
                transport: {
                    read: "/Asset/ListarModalidadBNV?var=" + Math.random()
                }
            }
        }).data("kendoComboBox");

        var IdOperador = $("#IdOperador").kendoComboBox({
            dataTextField: "Nombre",
            dataValueField: "Id",
            cascadeFrom: 'IdGrupo',
            filter: "contains",
            autoBind: false,
            delay: 500,
            minLength: 0,
            suggest: true,
            dataSource: {
                serverFiltering: true,
                schema: {
                    data: "Data",
                    total: "Count"
                },
                transport: {
                    read: "/Asset/ListarOperadorBNV?var=" + Math.random()
                }
            }
        }).data("kendoComboBox");

        var IdPlan = $("#IdPlan").kendoComboBox({
            dataTextField: "Nombre",
            dataValueField: "Id",
            cascadeFrom: 'IdOperador',
            filter: "contains",
            autoBind: false,
            delay: 500,
            minLength: 0,
            suggest: true,
            dataSource: {
                serverFiltering: true,
                schema: {
                    data: "Data",
                    total: "Count"
                },
                transport: {
                    read: {
                        url: "/Asset/ListarPlanBNV",
                        data: function () {
                            return {
                                idGrupo: IdGrupo.value(),
                                var: Math.random()
                            };
                        }
                    }
                }
            }
        }).data("kendoComboBox");

        var FEC_TICK = $("#ACQ_DATE").kendoDateTimePicker().data("kendoDateTimePicker");
        var FechaFin = $("#FechaFin").kendoDateTimePicker().data("kendoDateTimePicker");

        FEC_TICK.bind("change", function () {
            var fechaInicio = FEC_TICK.value();

            if (fechaInicio && IdContrato.text() == 'DaaS') {
                var fechaFin = new Date(fechaInicio);
                fechaFin.setFullYear(fechaFin.getFullYear() + 3);
                FechaFin.value(fechaFin);
            } else {
                FechaFin.value(null);
            }
        });

        $("#aplicacionesMovil").select2({
            placeholder: 'Seleccione...',
            allowClear: true,
            ajax: {
                url: "/Asset/ListarAplicacionesMovil",
                dataType: 'json',
                processResults: function (data) {
                    return { results: data };
                },
            },
        });

        $("#COST").kendoNumericTextBox({
            min: 0
        });

        $("#MontoTotal").kendoNumericTextBox({
            min: 0
        });

        $("#CantidadHD").kendoNumericTextBox({
            min: 0,
            decimals: 0
        });

        $("#SUM_ASSE").kendoEditor({
            encoded: false
        });
        var onSelectAttaCess = function (e) {
            $.each(e.files, function (index, value) {
                if (value.extension.toLowerCase() != ".pdf") {
                    e.preventDefault();
                    toastr.error("@ResourceLanguaje.Resource.AssetMessage8","@ResourceLanguaje.Resource.WrongFileExtension");
                }
            });
        };
        $("#archivos").kendoUpload({
            localization: {
                select: "Adjuntar"
            },
            select: onSelectAttaCess,
            multiple: false,
        });

        $("#submit").click(function () {
            toastr.info("Guardando...", "Espere por favor");
        });

        //MostrarDatosxGrupo(IdGrupo.text());

    });

</script>

<script type="text/javascript">
    function NewLocacion() {
        $("#NuevaLocacion").removeAttr("data-toggle");
        $("#NuevaLocacion").removeAttr("data-target");

        var IdGrupo = $("#IdGrupo").data("kendoComboBox");
        var UMinera = $("#UMinera").data("kendoComboBox");

        if (UMinera.dataItem() === undefined) {
            toastr.warning("Seleccione una unidad minera.", "Mensaje");
        }
        else {
            $("#lblTitulo").text("Nueva Locación");

            $("#NuevaLocacion").attr("data-toggle", "modal");
            $("#NuevaLocacion").attr("data-target", "#miModal");

            $(".modal-dialog").removeClass("modal-sm");
            $(".modal-dialog").removeClass("modal-lg");

            $('#modal-content').empty();
            $('#modal-content').load("/Location/CrearLocacionBNVAct/" + UMinera.dataItem().ID_ENTI + "?idGrupo=" + IdGrupo.dataItem().Id);
        }
    }

    function NewTypeAsset() {
        $("#NuevoTipoActivo").removeAttr("data-toggle");
        $("#NuevoTipoActivo").removeAttr("data-target");

        var IdGrupo = $("#IdGrupo").data("kendoComboBox");

        if (IdGrupo.dataItem() === undefined) {
            toastr.warning("Seleccione un grupo.", "Mensaje");
        } else {
            $("#lblTitulo").text("Nuevo Tipo de Activo");

            $("#NuevoTipoActivo").attr("data-toggle", "modal");
            $("#NuevoTipoActivo").attr("data-target", "#miModal");

            $(".modal-dialog").removeClass("modal-sm");
            $(".modal-dialog").removeClass("modal-lg");

            $('#modal-content').empty();
            $('#modal-content').load('/TypeAsset/Create/' + IdGrupo.dataItem().Id);
        }
    }

    function NewManufacturer() {
        $("#NuevaMarca").removeAttr("data-toggle");
        $("#NuevaMarca").removeAttr("data-target");

        var IdGrupo = $("#IdGrupo").data("kendoComboBox");

        if (IdGrupo.dataItem() === undefined) {
            toastr.warning("Seleccione un grupo.", "Mensaje");
        } else {
            $("#lblTitulo").text("Nueva Marca");

            $("#NuevaMarca").attr("data-toggle", "modal");
            $("#NuevaMarca").attr("data-target", "#miModal");

            $(".modal-dialog").removeClass("modal-sm");
            $(".modal-dialog").removeClass("modal-lg");

            $('#modal-content').empty();
            $('#modal-content').load('/Manufacturer/Create/' + IdGrupo.dataItem().Id);
        }
    }

    function NewCommercialModel() {
        $("#NuevoModeloComercial").removeAttr("data-toggle");
        $("#NuevoModeloComercial").removeAttr("data-target");

        var ID_MANU = $("#ID_MANU").data("kendoComboBox");
        var IdGrupo = $("#IdGrupo").data("kendoComboBox");

        if (ID_MANU.dataItem() === undefined) {
            toastr.warning("Seleccione una marca.", "Mensaje");
        }
        else {
            ID_MN = ID_MANU.dataItem().ID_MANU;
            $("#lblTitulo").text("Nuevo Modelo Comercial");

            $("#NuevoModeloComercial").attr("data-toggle", "modal");
            $("#NuevoModeloComercial").attr("data-target", "#miModal");

            $(".modal-dialog").removeClass("modal-sm");
            $(".modal-dialog").removeClass("modal-lg");

            $('#modal-content').empty();
            $('#modal-content').load("/CommercialModel/Create/" + ID_MANU.dataItem().ID_MANU + "?idGrupo=" + IdGrupo.dataItem().Id);
        }
    }

    function NuevoContrato() {
        $("#NuevoContrato").removeAttr("data-toggle");
        $("#NuevoContrato").removeAttr("data-target");

        var IdGrupo = $("#IdGrupo").data("kendoComboBox");

        if (IdGrupo.dataItem() === undefined) {
            toastr.warning("Seleccione un grupo.", "Mensaje");
        } else {
            $("#lblTitulo").text("Nuevo Contrato");

            $("#NuevoContrato").attr("data-toggle", "modal");
            $("#NuevoContrato").attr("data-target", "#miModal");

            $(".modal-dialog").removeClass("modal-sm");
            $(".modal-dialog").removeClass("modal-lg");

            $('#modal-content').empty();
            $('#modal-content').load('/Contrato/Nuevo/' + IdGrupo.dataItem().Id);
        }
    }

    function NewOperador() {
        $("#NuevoOperador").removeAttr("data-toggle");
        $("#NuevoOperador").removeAttr("data-target");

        var IdGrupo = $("#IdGrupo").data("kendoComboBox");

        if (IdGrupo.dataItem() === undefined) {
            toastr.warning("Seleccione un grupo.", "Mensaje");
        } else {
            $("#lblTitulo").text("Nuevo Operador");

            $("#NuevoOperador").attr("data-toggle", "modal");
            $("#NuevoOperador").attr("data-target", "#miModal");

            $(".modal-dialog").removeClass("modal-sm");
            $(".modal-dialog").removeClass("modal-lg");

            $('#modal-content').empty();
            $('#modal-content').load('/Maintenance/CreateOperador/' + IdGrupo.dataItem().Id);
        }
    }

    function NewPlan() {
        $("#NuevoPlan").removeAttr("data-toggle");
        $("#NuevoPlan").removeAttr("data-target");

        var IdOperador = $("#IdOperador").data("kendoComboBox");
        var IdGrupo = $("#IdGrupo").data("kendoComboBox");

        if (IdOperador.dataItem() === undefined) {
            toastr.warning("Seleccione un operador.", "Mensaje");
        }
        else {
            $("#lblTitulo").text("Nuevo Plan");

            $("#NuevoPlan").attr("data-toggle", "modal");
            $("#NuevoPlan").attr("data-target", "#miModal");

            $(".modal-dialog").removeClass("modal-sm");
            $(".modal-dialog").removeClass("modal-lg");

            $('#modal-content').empty();
            $('#modal-content').load("/Maintenance/CreatePlan/" + IdOperador.dataItem().Id + "?idGrupo=" + IdGrupo.dataItem().Id);
        }
    }

    function NewAplicacion() {
        $("#NuevaAplicacion").removeAttr("data-toggle");
        $("#NuevaAplicacion").removeAttr("data-target");

        var IdGrupo = $("#IdGrupo").data("kendoComboBox");

        if (IdGrupo.dataItem() === undefined) {
            toastr.warning("Seleccione un grupo.", "Mensaje");
        } else {
            $("#lblTitulo").text("Nueva Aplicación");

            $("#NuevaAplicacion").attr("data-toggle", "modal");
            $("#NuevaAplicacion").attr("data-target", "#miModal");

            $(".modal-dialog").removeClass("modal-sm");
            $(".modal-dialog").removeClass("modal-lg");

            $('#modal-content').empty();
            $('#modal-content').load('/Maintenance/CreateAplicacion/' + IdGrupo.dataItem().Id);
        }
    }

    function MostrarDatosxGrupo(g) {
        var Grupo = g;
        //var IdGrupo = $("#IdGrupo").data("kendoComboBox");

        //if (IdGrupo.dataItem() !== undefined) {
        //    Grupo = IdGrupo.dataItem().Nombre;
        //}

        LimpiarValores();
        $(".divInfraestructuraSer").css("display", "none");
        $(".divMicroinformaticoDass").css("display", "none");

        if (Grupo == "MICROINFORMATICO") {
            $(".divInfraestructura").css("display", "none");
            $(".divMovil").css("display", "none");
            $(".divMicroinformatico").css("display", "block");
            $("#txtNombre").text("Nombre de Equipo");
            $("#txtContrato").text("Proyecto");
            $("#txtTarifa").text("Tarifa USD");
            $("#txtComentario").text("Descripción del Equipo");
            $("#txtFFin").text("Fin");

            if ('@Session["SUPERVISOR_ACTIVOS_BNV_MICROINFORMATICO"]' == '1') {
                AgregarSupervisor(Grupo);
            }

        } else if (Grupo == "INFRAESTRUCTURA") {
            $(".divMicroinformatico").css("display", "none");
            $(".divMovil").css("display", "none");
            $(".divInfraestructura").css("display", "block");
            $("#txtNombre").text("Nombre de Equipo");
            $("#txtContrato").text("Contrato");
            $("#txtIpLocal").text("IP Local");
            $("#txtComentario").text("Comentario");

            if ('@Session["SUPERVISOR_ACTIVOS_BNV_INFRAESTRUCTURA"]' == '1') {
                AgregarSupervisor(Grupo);
            }

        } else if (Grupo == "MOVIL") {
            $(".divMicroinformatico").css("display", "none");
            $(".divInfraestructura").css("display", "none");
            $(".divMovil").css("display", "block");
            $("#txtNombre").text("IMEI");
            $("#txtContrato").text("Contrato");
            $("#txtTarifa").text("Monto Mensual sin IGV");
            $("#txtFFin").text("Renovación");
            $("#txtIpLocal").text("Anexo");
            $("#txtComentario").text("Comentario");
            $(".bFechasMovil").css("display", "none");
            $(".divMicroinformaticoDass").css("display", "block");

            if ('@Session["SUPERVISOR_ACTIVOS_BNV_MOVIL"]' == '1') {
                AgregarSupervisor(Grupo);
            }

        }
    }

    function LimpiarValores() {
        $("#SER_NUMB").val("");
        $("#NAM_EQUI").val("");
        $("#COST").data("kendoNumericTextBox").value(null);
        $("#MontoTotal").data("kendoNumericTextBox").value(null);
        $("#ACQ_DATE").data("kendoDateTimePicker").value(null);
        $("#FechaFin").data("kendoDateTimePicker").value(null);
        $("#IpLocal").val("");
        $("#MAC_ADRR").val("");
        $("#CantidadHD").data("kendoNumericTextBox").value(null);
        $("#ProcesadorRam1").val("");
        $("#ProcesadorRam2").val("");
        $("#CapacidadHD").val("");

        $('#NuevoTipoActivo').removeAttr('onclick style title');
        $('#NuevaMarca').removeAttr('onclick style title');
        $('#NuevoModeloComercial').removeAttr('onclick style title');
        $('#NuevaLocacion').removeAttr('onclick style title');
    }

    function AgregarSupervisor(Grupo) {
        $('#NuevoTipoActivo').attr({
            'onclick': 'NewTypeAsset()',
            'style': 'cursor:pointer;color:royalblue',
            'title': 'Clic aquí para registrar un tipo activo'
        });

        $('#NuevaMarca').attr({
            'onclick': 'NewManufacturer()',
            'style': 'cursor:pointer;color:royalblue',
            'title': 'Clic aquí para registrar una marca'
        });

        $('#NuevoModeloComercial').attr({
            'onclick': 'NewCommercialModel()',
            'style': 'cursor:pointer;color:royalblue',
            'title': 'Clic aquí para registrar un modelo comercial'
        });

        $('#NuevaLocacion').attr({
            'onclick': 'NewLocacion()',
            'style': 'cursor:pointer;color:royalblue',
            'title': 'Clic aquí para registrar una locación'
        });

        $('#NuevoOperador').attr({
            'onclick': 'NewOperador()',
            'style': 'cursor:pointer;color:royalblue',
            'title': 'Clic aquí para registrar un operador'
        });

        $('#NuevoPlan').attr({
            'onclick': 'NewPlan()',
            'style': 'cursor:pointer;color:royalblue',
            'title': 'Clic aquí para registrar un plan'
        });

        if (Grupo == 'MOVIL') {
            $('#NuevoContrato').attr({
                'onclick': 'NuevoContrato()',
                'style': 'cursor:pointer;color:royalblue',
                'title': 'Clic aquí para registrar un contrato'
            });
        }

        $('#NuevaAplicacion').attr({
            'onclick': 'NewAplicacion()',
            'style': 'cursor:pointer;color:royalblue',
            'title': 'Clic aquí para registrar una aplicación'
        });
    }

</script>

<script type="text/javascript">
    function cancel() {
        location = "http://" + location.host + "/Asset/Index";
    }

    function uploadDone(msg, code, idActivo) {

        if (msg == "OK") {
            $("#btnMensajeConfirmacion").click();

            $("#lblTitulo").text("Información Guardada");

            $(".modal-dialog").removeClass("modal-sm");
            $(".modal-dialog").removeClass("modal-lg");
            $(".modal-dialog").addClass("modal-sm");

            $('#modal-content').empty();
            $('#modal-content').html("<div class='form-group row'><div class='col-md-12'>Información del Nuevo Activo ha sido guardado correctamente.</div></div>" +
                /*"<div class='form-group row'><div class='col-md-6'><button class='btn btn-light btn-block' id='btnAgregarHW'>Agregar HW</button></div>" +*/
                "<div class='form-group row'><div class='col-md-6'></div>" +
                "<div class='col-md-6'><button class='btn btn-primary btn-block' id='btnContinuar'>Continuar</button></div></div> ");


            $(".close").click(function () {
                location = "http://" + location.host + "/Asset/Detalle/" + idActivo;
            });

            var undo = $("#btnAgregarHW").bind("click", function () {

                $("#lblTitulo").text("Agregar/Actualizar HW");

                $(".modal-dialog").removeClass("modal-sm");
                $(".modal-dialog").removeClass("modal-lg");
                $(".modal-dialog").addClass("modal-lg");
                $("#btnAgregarHW").attr("data-backdrop", "static");

                $('#modal-content').empty();
                $('#modal-content').load("/Asset/Componentes/" + idActivo + "?crea=1&var=" + Math.random());
            });

            $("#btnContinuar").click(function () {
                $("[data-dismiss=modal]").trigger({ type: "click" });
                location = "http://" + location.host + "/Asset/Detalle/" + idActivo;
            });
        } else if (msg == "INFO") {
            toastr.warning(code, "Mensaje");
        } else {

            var titleAsset = '';
            var messageAsset = '';
            if (code == '0') {
                titleAsset = 'Alerta';
                messageAsset = 'Por favor completar la información';
            }
            else if (code == '1') {
                titleAsset = 'Alerta';
                messageAsset = 'Contacte al administrador';
            }
            else if (code == '2') {
                titleAsset = 'Sesión expirada';
                messageAsset = 'Por favor vuelva a ingresar al sistema.';
            }
            else if (code == '3') {
                titleAsset = 'Duplicidad de Activos';
                messageAsset = 'La serie ingresada ya existe. Por favor validar.';
            }

            toastr.warning(messageAsset, "Mensaje");

        }
    }
    //
</script>